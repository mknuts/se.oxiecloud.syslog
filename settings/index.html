<!DOCTYPE html>
<html>
<head>
  <script type="text/javascript" src="/homey.js" data-origin="settings"></script>
  <style>
    /* Centrerar knapp-containern och lägger lite mellanrum mellan knapparna */
    .homey-form-buttons {
      display: flex;
      justify-content: center;
      gap: 10px; /* Ger ett snyggt avstånd mellan knapparna */
      margin-top: 20px;
    }
    
    /* Valfritt: Om du vill att knapparna ska ha samma bredd kan du lägga till: */
    /* .homey-button-primary, .homey-button-secondary { min-width: 150px; } */
  </style>
</head>
<body class="homey-visual-baseline">
  <header class="homey-header">
    <h1 class="homey-title" data-i18n="settings.title">Syslog Settings</h1>
    <p class="homey-subtitle" data-i18n="settings.intro"></p>
  </header>

  <fieldset class="homey-form-fieldset">
    <div class="homey-form-group">
      <label class="homey-label" for="syslogHost" data-i18n="settings.hostLabel"></label>
      <input class="homey-form-input" id="syslogHost" type="text" placeholder="192.168.1.100" />
    </div>

    <div class="homey-form-group">
      <label class="homey-label" for="syslogPort" data-i18n="settings.portLabel"></label>
      <input class="homey-form-input" id="syslogPort" type="number" placeholder="514" />
    </div>
  </fieldset>

  <div class="homey-form-buttons">
    <button id="test" class="homey-button-secondary" data-i18n="settings.test">Send Test Message</button>
    <button id="save" class="homey-button-primary" data-i18n="settings.save">Save Settings</button>
  </div>

  <script type="text/javascript">
    function onHomeyReady(Homey) {
      const hostInput = document.getElementById('syslogHost');
      const portInput = document.getElementById('syslogPort');
      const saveBtn = document.getElementById('save');
      const testBtn = document.getElementById('test');

      Homey.get('syslogHost', (err, value) => { if (value) hostInput.value = value; });
      Homey.get('syslogPort', (err, value) => { if (value) portInput.value = value; });

      saveBtn.addEventListener('click', () => {
        Homey.set('syslogHost', hostInput.value);
        Homey.set('syslogPort', portInput.value);
        Homey.alert(Homey.__('settings.saved')); 
      });

      testBtn.addEventListener('click', () => {
        Homey.api('POST', '/testConnection', {})
          .then(() => {
            Homey.alert(Homey.__('settings.testSuccess'));
          })
          .catch(err => {
            Homey.alert(Homey.__('settings.testError') + ': ' + err);
          });
      });

      Homey.ready();
    }
  </script>
</body>
</html>